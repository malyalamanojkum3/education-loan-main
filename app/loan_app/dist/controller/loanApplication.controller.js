sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/m/MessageToast","sap/ui/model/json/JSONModel"],(e,t,a,o)=>{"use strict";return e.extend("loanapp.controller.loanApplication",{onInit(){var e=new o("odata/v4/my/customer");this.getView().setModel(e)},onAfterRendering:function(){const e=["enterApplicantName","enterApplicantAddress","enterApplicantMobileNo","enterEmailId","enterAadhaarNo","enterPanNo","enterSalary","enterloanamount","enterloanrepaymentmonths"];e.forEach((t,a)=>{const o=this.byId(t);if(o){o.attachBrowserEvent("keydown",t=>{if(t.key==="Enter"){t.preventDefault();const o=e[a+1];if(o){const e=this.byId(o);if(e){e.focus()}}}})}})},onSubmit(){sap.ui.core.BusyIndicator.show(0);var e=this.getView().byId("enterApplicantName").getValue();var o=this.getView().byId("enterApplicantAddress").getValue();var n=this.getView().byId("enterApplicantMobileNo").getValue();var l=this.getView().byId("enterEmailId").getValue();var r=this.getView().byId("enterAadhaarNo").getValue();var s=this.getView().byId("enterPanNo").getValue();var i=this.getView().byId("enterSalary").getValue();var u=this.getView().byId("enterloanamount").getValue();var c=this.getView().byId("enterloanrepaymentmonths").getValue();console.log("Applicant Name:",e);console.log("Applicant Address:",o);console.log("Applicant Mobile No:",n);console.log("Applicant Email Id:",l);console.log("Aadhaar No:",r);console.log("PAN No:",s);console.log("Salary:",i);console.log("Loan Amount:",u);console.log("Loan Repayment Months:",c);var p=/^[a-zA-Z\s]+$/;var d=/^[0-9]{10}$/;var h=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;var V=/^[0-9]{12}$/;var m=/[A-Z]{5}[0-9]{4}[A-Z]{1}$/;var S=/^[0-9]*$/;var g=/^[0-9]*$/;var y=/^[0-9]{1,2}$/;let A=[];if(!e.match(p))A.push("Applicant name (only alphabets are allowed)");if(!n.match(d))A.push("Applicant Mobile No (Must be 10 digits");if(!l.match(h))A.push("Applicant Email Id (Invalid email format)");if(!r.match(V))A.push("Applicant Aadhaar No (Must be 12 digits)");if(!s.match(m))A.push("Applicant PAN No (Invalid Pan No format)");if(!i.match(S))A.push("Applicant Salary (only numbers allowed)");if(!u.match(g))A.push("Applicant LoanAmount (only Numbers are allowed)");if(!c.match(y))A.push("Applicant Repaymonths (upto 2 digits)");if(A.length>0){sap.m.MessageBox.error("Please correct the following fields:\n"+A.join("\n"),{onClose:()=>{sap.ui.core.BusyIndicator.hide(0)}});return}let f=[];if(!e)f.push("Applicant Name");if(!o)f.push("Applicant Address");if(!n)f.push("Applicant Moblie No");if(!r)f.push("Applicant Aadhaar No");if(!l)f.push("Applicant Email Id");if(!s)f.push("PAN No");if(!i)f.push("Applicant Salary");if(!u)f.push("Loan Amount");if(!c)f.push("Loan Repayment Months");if(f.length>0){sap.m.MessageBox.error("Please fill the required fields:\n"+f.join("\n"),{onClose:()=>{sap.ui.core.BusyIndicator.hide(0)}});return}var v={applicantName:e,applicantAddress:o,applicantPHno:n,applicantEmail:l,applicantAadhar:r,applicantPAN:s,applicantSalary:i,loanAmount:u,loanRepaymentMonths:c};$.ajax({url:"/odata/v4/my/submitLoanApplication",method:"POST",contentType:"application/json",data:JSON.stringify(v),success:e=>{sap.ui.core.BusyIndicator.hide(0);t.success("You have applied for loan successfully\nYour loan id:"+e.Id,{onClose:()=>{this.byId("enterApplicantName").setValue("");this.byId("enterApplicantAddress").setValue("");this.byId("enterApplicantMobileNo").setValue("");this.byId("enterEmailId").setValue("");this.byId("enterAadhaarNo").setValue("");this.byId("enterPanNo").setValue("");this.byId("enterSalary").setValue("");this.byId("enterloanamount").setValue("");this.byId("enterloanrepaymentmonths").setValue("");var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("dashboard")}})},error:e=>{a.show("Error submitting: "+e.responseText)}})},onCancel(){sap.m.MessageToast.show("Loan application cancelled")},onChooseFile:function(){var e=document.createElement("input");e.type="file";e.onchange=function(e){var t=e.target.files[0];this._file=t;var a=this.byId("filePath");a.setValue(t.name)}.bind(this);e.click()},onClear:function(){this.byId("enterApplicantName").setValue("");this.byId("enterApplicantAddress").setValue("");this.byId("enterApplicantMobileNo").setValue("");this.byId("enterEmailId").setValue("");this.byId("enterAadhaarNo").setValue("");this.byId("enterPanNo").setValue("");this.byId("enterSalary").setValue("");this.byId("enterloanamount").setValue("");this.byId("enterloanrepaymentmonths").setValue("");this.byId("selectDocumentType").setSelectedKey(null)},nameValidation:function(e){var t=e.getSource().getValue();var a=e.getSource();var o=/^[a-zA-Z\s]+$/;var n=t.length;if(n==50){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("More Than 50 Characters Not Accepted")}else if(!t.match(o)){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Only Alphabets can Accepted")}else{a.setValueState(sap.ui.core.ValueState.None)}},numValidation:function(e){var t=e.getSource().getValue();var a=e.getSource();var o=/^[0-9]{10}$/;var n=t.length;if(n!==10){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Mobile number must be 10 digits")}else if(!t.match(o)){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Only Numbers can Accepted")}else{a.setValueState(sap.ui.core.ValueState.None)}},emailValidation:function(e){var t=e.getSource().getValue();var a=e.getSource();var o=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!t.match(o)){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Invalid email address")}else{a.setValueState(sap.ui.core.ValueState.None)}},aadhaarValidation:function(e){var t=e.getSource().getValue();var a=e.getSource();var o=/^[0-9]{12}$/;var n=t.length;if(n!==12){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Aadhaar number must be 12 digits")}else if(!t.match(o)){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Only Numbers can Accepted")}else{a.setValueState(sap.ui.core.ValueState.None)}},panValidation:function(e){var t=e.getSource().getValue().toUpperCase();e.getSource().setValue(t);var t=e.getSource().getValue();var a=e.getSource();var o=/[A-Z]{5}[0-9]{4}[A-Z]{1}$/;var n=t.length;if(n!==10){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Pan number must be 10 digits")}else if(!t.match(o)){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Invalid Pan number")}else{a.setValueState(sap.ui.core.ValueState.None)}},repayValidation:function(e){var t=e.getSource().getValue();var a=e.getSource();var o=/^[0-9]{1,2}$/;var n=t.length;if(n===0||n>2){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Repayment months allowed upto 2 digits")}else if(!t.match(o)){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Only Numbers can Accepted")}else{a.setValueState(sap.ui.core.ValueState.None)}},salaryValidation:function(e){var t=e.getSource().getValue();var a=e.getSource();var o=/^[0-9]*$/;var n=t.length;if(n===0){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Salary cannot be empty")}else if(!t.match(o)){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Only Numbers can Accepted")}else{a.setValueState(sap.ui.core.ValueState.None)}},loanamountValidation:function(e){var t=e.getSource().getValue();var a=e.getSource();var o=/^[0-9]*$/;var n=t.length;if(n===0){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Loan Amount cannot be empty")}else if(!t.match(o)){a.setValueState(sap.ui.core.ValueState.Error);a.setValueStateText("Only Numbers can Accepted")}else{a.setValueState(sap.ui.core.ValueState.None)}},onLogout:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("main");a.show("Logged out!")},onHome:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("dashboard");a.show("Returned Home")}})});
//# sourceMappingURL=loanApplication.controller.js.map